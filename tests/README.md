## Общая информация

Для тестирования библиотеки используются два вида тестов - Jest и Playwright.
Jest не может покрыть кейсы с компонентами использующими Browser API, Playwright же покрывает все возможные кейсы использования компонентов

## Установка браузров для Playwright

```shell
$ npx playwright install
```

Дополнительную информацию по установке можно найти на [официальном сайте](https://playwright.dev/docs/browsers)

## Запуск тестов

1. Playwright

```shell
$ npm run test:e2e
```

Запуск в режиме UI

```shell
$ npm run test:e2e-ui
```

2. Jest

```shell
$ npm run test -- -u
```

## Workers

Настроить количество workers можно в файле .env в корне проекта, указав значение переменной

```
PW_WORKERS='3'
```

По умолчанию это значение 1

## Рекомендации

Каждый тест должен быть полностью независимым

1. Не зависит от порядка выполнения тестов
2. Не делит состояние между тестами
3. Каждый тест сам подготавливает нужные данные
4. Каждый тест сам очищает за собой

Один тест = одна проверка

1. Тестируйте одну конкретную функциональность
2. Если тест падает — должно быть понятно что именно сломалось
3. Избегайте "монолитных" тестов на всё сразу

## Вспомогательные функции

В папке utils.ts находятся такие вспомогательные функции как:

- Работа с Storybook iframe
  getStorybookFrameLocator - получение фрейма для изолированного тестирования компонентов

- Взаимодействие с ui
  resizeElement - программно меняет размер элемента через inline-стили и дожидается применения новых размеров.

- Работа с датами
  parseRuInputDate - парсит дату из формата DD.MM.YYYY в Date объект (UTC);
  formatRuDate - форматирует Date в формат DD.MM.YYYY (UTC);
  parseDateOrNull - создает дату из строки формата DD.MM.YYYY или возвращает null для маски;
  isValidDateFormat - Валидирует формат даты DD.MM.YYYY;
  isValidDateRangeFormat - Валидирует формат диапазона дат DD.MM.YYYY - DD.MM.YYYY;

- Работа с календарём
  getVisibleDayIndices - получает индексы видимых и кликабельных дней календаря;
  findDayIndexAfter - находит индекс дня в календаре, который больше указанного дня;
  getCalendarPanelDate - получает текст месяца и года из панели календаря;
  getCalendarNavigationButtons - получает кнопки навигации (prev/next) из панели календаря;
  isDateInRange - проверяет, что дата находится в диапазоне (включительно);

В файле constants.ts указаны основные константы, используемы при работе с тестами - таймауты, комбинации клавиш.
